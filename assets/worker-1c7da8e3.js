var f=Object.defineProperty;var m=(e,h,c)=>h in e?f(e,h,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[h]=c;var s=(e,h,c)=>(m(e,typeof h!="symbol"?h+"":h,c),c);(function(){"use strict";class e{constructor(n,w){s(this,"_char");s(this,"_pixels");this._char=n,this._pixels=w}set letter(n){this._char=n}get letter(){return this._char}set pixels(n){this._pixels=n}get pixels(){return this._pixels}}class h{constructor(){s(this,"_characterLexicon",[new e("À",6),new e("Á",6),new e("Â",6),new e("È",6),new e("Ê",6),new e("Ë",6),new e("Í",4),new e("Ó",6),new e("Ô",6),new e("Õ",6),new e("Ú",6),new e("ß",6),new e("ã",6),new e("õ",6),new e("ğ",6),new e("İ",4),new e("ı",4),new e("Œ",6),new e("œ",7),new e("Ş",6),new e("ş",6),new e("Ŵ",6),new e("ŵ",6),new e("ž",6),new e("ȇ",6),new e("!",2),new e('"',5),new e("#",6),new e("$",6),new e("%",6),new e("&",6),new e("'",3),new e("(",5),new e(")",5),new e("*",5),new e("+",6),new e(",",2),new e("-",6),new e(".",2),new e("/",6),new e("0",6),new e("1",6),new e("2",6),new e("3",6),new e("4",6),new e("5",6),new e("6",6),new e("7",6),new e("8",6),new e("9",6),new e(":",2),new e(";",2),new e("<",5),new e("=",6),new e(">",5),new e("?",6),new e("@",7),new e("A",6),new e("B",6),new e("C",6),new e("D",6),new e("E",6),new e("F",6),new e("G",6),new e("H",6),new e("I",4),new e("J",6),new e("K",6),new e("L",6),new e("M",6),new e("N",6),new e("O",6),new e("P",6),new e("Q",6),new e("R",6),new e("S",6),new e("T",6),new e("U",6),new e("V",6),new e("W",6),new e("X",6),new e("Y",6),new e("Z",6),new e("[",4),new e("]",4),new e("^",6),new e("_",6),new e("`",3),new e("a",6),new e("b",6),new e("c",6),new e("d",6),new e("e",6),new e("f",5),new e("g",6),new e("h",6),new e("i",2),new e("j",6),new e("k",5),new e("l",3),new e("m",6),new e("n",6),new e("o",6),new e("p",6),new e("q",6),new e("r",6),new e("s",6),new e("t",4),new e("u",6),new e("v",6),new e("w",6),new e("x",6),new e("y",6),new e("z",6),new e("‘",3),new e("’",3),new e("{",5),new e("|",2),new e("}",5),new e("~",7),new e("–",7),new e("Ç",6),new e("ü",6),new e("é",6),new e("â",6),new e("ä",6),new e("à",6),new e("å",6),new e("ç",6),new e("ê",6),new e("ë",6),new e("è",6),new e("ï",4),new e("î",6),new e("ì",3),new e("Ä",6),new e("Å",6),new e("É",6),new e("æ",6),new e("Æ",6),new e("ô",6),new e("ö",6),new e("ò",6),new e("û",6),new e("ù",6),new e("ÿ",6),new e("Ö",6),new e("Ü",6),new e("ø",6),new e("£",6),new e("Ø",6),new e("×",4),new e("ƒ",6),new e("á",6),new e("í",3),new e("ó",6),new e("ú",6),new e("ñ",6),new e("Ñ",6),new e("ª",6),new e("º",6),new e("¿",6),new e("®",7),new e("¬",6),new e("½",6),new e("¼",6),new e("¡",2),new e("«",6),new e("»",6),new e("░",8),new e("▒",9),new e("▓",9),new e("│",6),new e("┤",6),new e("╡",6),new e("╢",8),new e("╖",8),new e("╕",6),new e("╣",8),new e("║",8),new e("╗",8),new e("╝",8),new e("╜",8),new e("╛",6),new e("┐",6),new e("└",9),new e("┴",9),new e("┬",9),new e("├",9),new e("─",9),new e("┼",9),new e("╞",9),new e("╟",9),new e("╚",9),new e("╔",9),new e("╩",9),new e("╦",9),new e("╠",9),new e("═",9),new e("╬",9),new e("╧",9),new e("╨",9),new e("╤",9),new e("╥",9),new e("╙",9),new e("╘",9),new e("╒",9),new e("╓",9),new e("╫",9),new e("╪",9),new e("┘",6),new e("┌",9),new e("█",9),new e("▄",9),new e("▌",5),new e("▐",9),new e("▀",9),new e("α",8),new e("β",7),new e("Γ",7),new e("π",8),new e("Σ",7),new e("σ",8),new e("μ",8),new e("τ",8),new e("Φ",7),new e("Θ",8),new e("Ω",8),new e("δ",7),new e("∞",9),new e("∅",9),new e("∈",6),new e("∩",7),new e("≡",7),new e("±",7),new e("≥",7),new e("≤",7),new e("⌠",9),new e("⌡",6),new e("÷",7),new e("≈",8),new e("°",7),new e("∙",6),new e("·",6),new e("√",9),new e("ⁿ",7),new e("²",6),new e("■",7),new e(" ",4),new e(`
`,0)])}get characterLexicon(){return this._characterLexicon}}class c{constructor(n){s(this,"_text");this._text=n}convertTextToPixels(n){const w=[],r=new h().characterLexicon,a=114;let i=0,o="";for(let t=0;t<n.length;t++){const _=r.find(p=>p.letter==n.charAt(t));if(!_){n=n.substring(0,t)+n.substring(t+1),t--;continue}i+=_.pixels,o=n.substring(0,t+1),i>a&&(o=o.substring(0,o.length-1),w.push({word:o,value:i-_.pixels}),n=n.substring(t),i=0,t=-1)}return w.push({word:n,value:i}),w}convertTextToLines(){let n=[],w=[],r=0;const a=[],i=this._text.replace(/ +\n/g,`
`).split(/(\s)/g);for(let o=0;o<i.length;o++){w=this.convertTextToPixels(i[o]);for(let t=0;t<w.length;t++)r+=w[t].value,(w[t].word===`
`||w[t].word!=" "&&r>114)&&(r=w[t].value,a.push(n.join("")),n=[]),n.push(w[t].word)}return a.push(n.join("").trim()),a.filter(o=>o!="")}}class u{constructor({generationFormat:n,minecraftVersion:w,title:r,author:a,linesPerPage:i=14,nameSuffix:o="",text:t}){s(this,"_calculator");s(this,"_title");s(this,"_author");s(this,"_minecraftVersion");s(this,"_generationFormat");s(this,"_lines");s(this,"_pages",[]);s(this,"_workerLine","");s(this,"_linesPerPage");s(this,"_nameSuffix");s(this,"_booksCounter",0);s(this,"book",[]);this._generationFormat=n,this._minecraftVersion=w,this._title=r,this._author=a,this._linesPerPage=i>14?14:i,this._nameSuffix=o,this._calculator=new c(t),this._lines=this._calculator.convertTextToLines(),this.book=this.createOutput()}escapeCharacters(){this._generationFormat==="commands"?this._workerLine=this._workerLine.replace(/"/g,'\\\\"').replace(/'/g,"\\'").trim().replace(/\n/g,"\\\\n"):this._generationFormat==="text"?this._workerLine=this._workerLine.trim():this._workerLine=""}encapsuleText(){return this._generationFormat==="commands"?`'{"text":"${this._workerLine}"}'`:this._generationFormat==="text"?this._workerLine:""}finalizeBook(){if(this._generationFormat==="commands"){const n=this._nameSuffix.replace("n",this._booksCounter.toString());return`/give @p written_book[written_book_content={title:"${this._title+n}",author:"${this._author}",pages:[${this._pages.toString()}]}] 1`}else return this._generationFormat==="text"?this._pages.toString():""}createBook(n){let w=0;if(this._pages=n.map(r=>{if(this._workerLine+=r,w++,w==this._linesPerPage){this.escapeCharacters();const a=this.encapsuleText();return this._workerLine="",w=0,a}else return null}).filter(r=>r!==null),this._workerLine.length>0){this.escapeCharacters();const r=this.encapsuleText();this._pages.push(r)}return this.finalizeBook()}createOutput(){const n=[],w=[...this._lines];let r=0,a=0;this._generationFormat==="commands"?a=this._minecraftVersion==="bedrock"?this._linesPerPage*50:this._linesPerPage*100:this._generationFormat==="text"&&(a=13);for(let i=0;i<=this._lines.length;i++)if(r++,r==a||i==this._lines.length){const o=w.splice(0,r),t=this.createBook(o);r=0,this._booksCounter++,n.push(t)}return n}}class g{constructor(n){s(this,"_bookParameters");this._bookParameters=n}generateBook(){return new u(this._bookParameters).book}get bookParameters(){return this._bookParameters}}self.onmessage=l=>{const n=new g(l.data).generateBook();self.postMessage(n)}})();
